<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="datavolley">
<title>datavolley • datavolley</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Raleway-0.4.5/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.5/font.css" rel="stylesheet">
<link href="../deps/Patua_One-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="datavolley">
<meta property="og:description" content="datavolley">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">datavolley</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.9.9900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/datavolley.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openvolley/datavolley/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>datavolley</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openvolley/datavolley/blob/HEAD/vignettes/datavolley.Rmd" class="external-link"><code>vignettes/datavolley.Rmd</code></a></small>
      <div class="d-none name"><code>datavolley.Rmd</code></div>
    </div>

    
    
<p>An R package for reading volleyball scouting files in DataVolley
format (<code>*.dvw</code>), collected for example with the commercial
DataVolley, Click and Scout, or VolleyStation software.</p>
<p>See also:</p>
<ul>
<li>these <a href="https://openvolley.github.io/volley-analytics-snippets" class="external-link">code
snippets</a> for volleyball analytics in R with datavolley and the other
openvolley packages</li>
<li>this <a href="https://apps.untan.gl/dvalidate/" class="external-link">DataVolley file
validator</a> and <a href="https://apps.untan.gl/" class="external-link">suite of analytical
apps</a>, which are built on the datavolley package.</li>
</ul>
<p>The <a href="https://github.com/openvolley/peranavolley" class="external-link">peranavolley</a>
package provides similar functionality for reading files scouted by the
<a href="http://peranasports.com/software/vbstatshd/" class="external-link">AOC VBStats</a>
software.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"datavolley"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://openvolley.r-universe.dev"</span>,
                                         <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## or</span>

<span class="co">## install.packages("remotes") ## if needed</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"openvolley/datavolley"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Read one of the example data files bundled with the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://datavolley.openvolley.org" class="external-link">datavolley</a></span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dv.html">dv_read</a></span><span class="op">(</span><span class="fu"><a href="../reference/dv_example_file.html">dv_example_file</a></span><span class="op">(</span><span class="op">)</span>, insert_technical_timeouts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Match summary:</span>
<span class="co">#&gt; Date: 2015-01-25</span>
<span class="co">#&gt; League: Finale mladinke</span>
<span class="co">#&gt; Teams: Braslovče (JERONČIČ ZORAN/MIHALINEC DAMIJANA)</span>
<span class="co">#&gt;        vs</span>
<span class="co">#&gt;        Nova KBM Branik (HAFNER MATJAŽ)</span>
<span class="co">#&gt; Result: 3-0 (25-16, 25-14, 25-22)</span>
<span class="co">#&gt; Duration: 67 minutes</span></code></pre></div>
<p>Note that if you are working with files that were scouted by
VolleyMetrics, they use some conventions in their files that differ from
standard DataVolley usage. There is an option to tell
<code>dv_read</code> to follow their conventions:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dv.html">dv_read</a></span><span class="op">(</span><span class="st">"/your/file.dvw"</span>, skill_evaluation_decode <span class="op">=</span> <span class="st">"volleymetrics"</span><span class="op">)</span></code></pre></div>
<p>Number of serves by team:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">serve_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_serves.html">find_serves</a></span><span class="op">(</span><span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">team</span><span class="op">[</span><span class="va">serve_idx</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Braslovče Nova KBM Branik </span>
<span class="co">#&gt;              74              54</span></code></pre></div>
<p>Distribution of serve run lengths:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">serve_run_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_runs.html">find_runs</a></span><span class="op">(</span><span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="va">serve_idx</span>, <span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">serve_run_info</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"run_id"</span>, <span class="st">"run_length"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">run_length</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  1  2  3  4  5  7  8 </span>
<span class="co">#&gt; 34 16  7  4  1  1  1</span></code></pre></div>
<p>The court position associated with each action can be recorded in two
ways. The most common is by zones (numbered 1-9).</p>
<p>Heatmap of attack rate by court zone (where the attack was made
from):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">## calculate attack frequency by zone, per team</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">skill</span> <span class="op">==</span> <span class="st">"Attack"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">team</span>, <span class="va">start_zone</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n_attacks <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="va">n_attacks</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n_attacks</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span>

<span class="co">## add x, y coordinates associated with the zones</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="../reference/dv_xy.html">dv_xy</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">start_zone</span>, end <span class="op">=</span> <span class="st">"lower"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## for team 2, these need to be on the top half of the diagram</span>
<span class="va">tm2i</span> <span class="op">&lt;-</span> <span class="va">attack_rate</span><span class="op">$</span><span class="va">team</span> <span class="op">==</span> <span class="fu"><a href="../reference/teams.html">teams</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="va">attack_rate</span><span class="op">[</span><span class="va">tm2i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dv_flip_xy.html">dv_flip_xy</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">[</span><span class="va">tm2i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="../reference/teams.html">teams</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Attack rate"</span><span class="op">)</span></code></pre></div>
<p><img src="datavolley_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>If you prefer a more colourful court, check the
<code>court_colour = "indoor"</code> option. Note that we make two calls
to <code>ggcourt</code> in this example, one with
<code>background_only = TRUE</code> to plot just the court background
colours, and again with <code>foreground_only = TRUE</code> to add the
grid lines and labels. Making two calls allows us to control the layer
order, so that the court colours are behind the heatmap, but the grid
lines are on top of it:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co">## plot just the background court colour</span>
    <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span>court_colour <span class="op">=</span> <span class="st">"indoor"</span>, background_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
    <span class="co">## add the heatmap</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="co">## now add the grid lines and labels</span>
    <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="../reference/teams.html">teams</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, court_colour <span class="op">=</span> <span class="st">"indoor"</span>, foreground_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Attack rate"</span><span class="op">)</span></code></pre></div>
<p><img src="datavolley_files/figure-html/indoor1-1.png" width="700"></p>
<p>Heatmap of where attacks ended, using only attacks by Nova KBM Branik
from position 4:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## calculate attack frequency by zone, per team</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">team</span> <span class="op">==</span> <span class="st">"Nova KBM Branik"</span> <span class="op">&amp;</span> <span class="va">skill</span> <span class="op">==</span> <span class="st">"Attack"</span> <span class="op">&amp;</span> <span class="va">start_zone</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">end_zone</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n_attacks <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="va">n_attacks</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n_attacks</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="../reference/dv_xy.html">dv_xy</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">end_zone</span>, end <span class="op">=</span> <span class="st">"lower"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span><span class="st">"lower"</span>, labels <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Rate: attack\nend location"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_tile()`).</span></code></pre></div>
<p><img src="datavolley_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>We can also use the end subzone information, if it has been recorded.
The subzones divide each zone into four, so we get higher spatial
resolution (but the subzone is not always scouted). The same plot as
above, but using subzones:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">team</span> <span class="op">!=</span> <span class="st">"Nova KBM Branik"</span> <span class="op">&amp;</span> <span class="va">skill</span> <span class="op">==</span> <span class="st">"Attack"</span> <span class="op">&amp;</span> <span class="va">start_zone</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">end_subzone</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">end_zone</span>, <span class="va">end_subzone</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n_attacks <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="va">n_attacks</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n_attacks</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span>
<span class="co">#&gt; `summarise()` has grouped output by 'end_zone'. You can override using the</span>
<span class="co">#&gt; `.groups` argument.</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="../reference/dv_xy.html">dv_xy</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">end_zone</span>, end <span class="op">=</span> <span class="st">"lower"</span>, subzones <span class="op">=</span> <span class="va">attack_rate</span><span class="op">$</span><span class="va">end_subzone</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span><span class="st">"lower"</span>, labels <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Rate: attack\nend location"</span><span class="op">)</span></code></pre></div>
<p><img src="datavolley_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Or using arrows to show the starting and ending zones of attacks:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## first tabulate attacks by starting and ending zone</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">team</span> <span class="op">==</span> <span class="fu"><a href="../reference/teams.html">teams</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">skill</span> <span class="op">==</span> <span class="st">"Attack"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">start_zone</span>, <span class="va">end_zone</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span>

<span class="co">## convert counts to rates</span>
<span class="va">attack_rate</span><span class="op">$</span><span class="va">rate</span> <span class="op">&lt;-</span> <span class="va">attack_rate</span><span class="op">$</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>

<span class="co">## discard zones with zero attacks or missing location information</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="va">attack_rate</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rate</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">start_zone</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">end_zone</span><span class="op">)</span><span class="op">)</span>

<span class="co">## add starting x, y coordinates</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="../reference/dv_xy.html">dv_xy</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">start_zone</span>, end <span class="op">=</span> <span class="st">"lower"</span>, xynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sx"</span>, <span class="st">"sy"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">## and ending x, y coordinates</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="../reference/dv_xy.html">dv_xy</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">end_zone</span>, end <span class="op">=</span> <span class="st">"upper"</span>, xynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ex"</span>, <span class="st">"ey"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">## plot in reverse order so largest arrows are on the bottom</span>
<span class="va">attack_rate</span> <span class="op">&lt;-</span> <span class="va">attack_rate</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">attack_rate</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/teams.html">teams</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">""</span><span class="op">)</span>, court_colour <span class="op">=</span> <span class="st">"indoor"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">)</span><span class="op">)</span>
    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">sx</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>, <span class="va">attack_rate</span><span class="op">$</span><span class="va">ex</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span>,
                                         y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">attack_rate</span><span class="op">$</span><span class="va">sy</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>, <span class="va">attack_rate</span><span class="op">$</span><span class="va">ey</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span>,
                                         rate <span class="op">=</span> <span class="va">attack_rate</span><span class="op">$</span><span class="va">rate</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span>,
                       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">rate</span><span class="op">)</span>, lineend <span class="op">=</span> <span class="st">"round"</span>,
                       arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"closed"</span>, angle <span class="op">=</span> <span class="fl">20</span>, ends <span class="op">=</span> <span class="st">"last"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span>
<span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span class="co">#&gt; <span style="color: #555555;">generated.</span></span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradient</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Attack rate"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>size <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="datavolley_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Another source of position data is court coordinates. These are not
included in all data files, because generally they must be manually
entered by the scout and this can be a time consuming process. For the
purposes of demonstration, here we generate fake coordinate data:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## take just the serves from the play-by-play data</span>
<span class="va">xserves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">skill</span> <span class="op">==</span> <span class="st">"Serve"</span><span class="op">)</span>

<span class="co">## if the file had been scouted with coordinate included, we could plot them directly</span>
<span class="co">## this file has no coordinates, so we'll fake some up for demo purposes</span>
<span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dv_fake_coordinates.html">dv_fake_coordinates</a></span><span class="op">(</span><span class="st">"serve"</span>, <span class="va">xserves</span><span class="op">$</span><span class="va">evaluation</span><span class="op">)</span>
<span class="va">xserves</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"start_coordinate"</span>, <span class="st">"start_coordinate_x"</span>, <span class="st">"start_coordinate_y"</span>,
            <span class="st">"end_coordinate"</span>, <span class="st">"end_coordinate_x"</span>, <span class="st">"end_coordinate_y"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">coords</span>

<span class="co">## now we can plot these</span>
<span class="va">xserves</span><span class="op">$</span><span class="va">evaluation</span><span class="op">[</span><span class="op">!</span><span class="va">xserves</span><span class="op">$</span><span class="va">evaluation</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ace"</span>, <span class="st">"Error"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Other"</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">xserves</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">start_coordinate_x</span>, <span class="va">start_coordinate_y</span>,
       xend <span class="op">=</span> <span class="va">end_coordinate_x</span>, yend <span class="op">=</span> <span class="va">end_coordinate_y</span>, colour <span class="op">=</span> <span class="va">evaluation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span>arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"closed"</span>, angle <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Ace <span class="op">=</span> <span class="st">"limegreen"</span>, Error <span class="op">=</span> <span class="st">"firebrick"</span>, Other <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span>,
                        name <span class="op">=</span> <span class="st">"Evaluation"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Serving team"</span>, <span class="st">"Receiving team"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="datavolley_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We could also use these coordinates to generate a heatmap-style plot
of serve location:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">xserves</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">start_coordinate_x</span>, <span class="va">start_coordinate_y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">stat_density_2d</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"raster"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, contour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="fl">1</span>, direction <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/ggcourt.html">ggcourt</a></span><span class="op">(</span><span class="st">"lower"</span>, labels <span class="op">=</span> <span class="st">"Serving team"</span><span class="op">)</span></code></pre></div>
<p><img src="datavolley_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="section level3">
<h3 id="analyzing-multiple-files-at-once">Analyzing multiple files at once<a class="anchor" aria-label="anchor" href="#analyzing-multiple-files-at-once"></a>
</h3>
<p>You might want to read multiple files in and analyze them all
together. First find all of the DataVolley files in the target
directory:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="st">"c:/data"</span>, pattern <span class="op">=</span> <span class="st">"dvw$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## if your files are in nested directories, add 'recursive = TRUE' to the arguments</span></code></pre></div>
<p>Read all of those files in a loop, extract the play-by-play component
from each, and then join of those all together:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## read each file</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">fi</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="va">lx</span><span class="op">[[</span><span class="va">fi</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dv.html">dv_read</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">fi</span><span class="op">]</span><span class="op">)</span>
<span class="co">## now extract the play-by-play component from each and bind them together</span>
<span class="va">px</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">fi</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">lx</span><span class="op">)</span><span class="op">)</span> <span class="va">px</span><span class="op">[[</span><span class="va">fi</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plays.html">plays</a></span><span class="op">(</span><span class="va">lx</span><span class="op">[[</span><span class="va">fi</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">px</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">px</span><span class="op">)</span></code></pre></div>
<p>(Note, the idiomatic R way to do this would be to use
<code>lapply</code> instead of <code>for</code> loops:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dv_read</span><span class="op">)</span>
<span class="va">px</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lx</span>, <span class="va">plays</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>It achieves the same thing. Use whichever you prefer.)</p>
<p>And then we could get dataset-wide statistics, for example reception
error rate by team:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="va">px</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">skill</span> <span class="op">==</span> <span class="st">"Reception"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">team</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>N_receptions <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, error_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">evaluation</span> <span class="op">==</span> <span class="st">"Error"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span>
<span class="co">#&gt;   team            N_receptions error_rate</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ACH Volley                32     0.031<span style="text-decoration: underline;">2</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Braslovče                 44     0.227 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Maribor                   64     0.188 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Nova KBM Branik           66     0.121</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<p>If you see unexpected behaviour, try
<code>dv_read(..., do_warn = TRUE, verbose = TRUE)</code> to obtain more
diagnostic information during the process of reading and parsing the
DataVolley file. Also check the text encoding specified to
<code>dv_read</code> (did you specify one??)</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ben Raymond, Adrien Ickowicz, Tyler Widdison.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
